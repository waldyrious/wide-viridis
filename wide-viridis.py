
from matplotlib.colors import ListedColormap
from numpy import nan, inf

# Used to reconstruct the colormap in viscm
parameters = {'xp': [0.99802706618578441, 7.5256635531304994, -38.207596801346781, -31.523569023568996, -6.9984573247720903],
              'yp': [-1.0893523228212985, -50.640047473719903, -0.26041666666665719, 36.805555555555571, 31.796239837398389],
              'min_Jp': 1.0416666666666679,
              'max_Jp': 95}

cm_data = [[ 0.00177832, 0.00111754, 0.00202897],
           [ 0.0028982 , 0.00198662, 0.00357546],
           [ 0.00425097, 0.00306723, 0.00555943],
           [ 0.00582453, 0.00434843, 0.00800597],
           [ 0.00761006, 0.00582351, 0.01092038],
           [ 0.00959915, 0.00748523, 0.01433453],
           [ 0.01178582, 0.00932985, 0.01825177],
           [ 0.0141632 , 0.01135158, 0.02271131],
           [ 0.016727  , 0.01354858, 0.02771128],
           [ 0.01947075, 0.0159154 , 0.0333021 ],
           [ 0.02239153, 0.01845206, 0.03947061],
           [ 0.02548232, 0.02115249, 0.04596359],
           [ 0.02874129, 0.02401831, 0.05243089],
           [ 0.03216134, 0.02704392, 0.05892931],
           [ 0.03574027, 0.03023057, 0.06543093],
           [ 0.03947197, 0.03357473, 0.07196031],
           [ 0.0432459 , 0.03707554, 0.07851539],
           [ 0.04694862, 0.04072791, 0.08508766],
           [ 0.05058862, 0.04436137, 0.09171163],
           [ 0.05417161, 0.04795587, 0.09835098],
           [ 0.05769546, 0.05151022, 0.10504058],
           [ 0.06116268, 0.05502876, 0.11176815],
           [ 0.0645758 , 0.05851573, 0.11852043],
           [ 0.06792968, 0.06196801, 0.1253434 ],
           [ 0.0712292 , 0.06539253, 0.13219936],
           [ 0.07447448, 0.0687915 , 0.1390884 ],
           [ 0.0776592 , 0.07216206, 0.14605223],
           [ 0.08078741, 0.07551044, 0.15305665],
           [ 0.08385826, 0.07883872, 0.16010141],
           [ 0.08686752, 0.08214682, 0.16720455],
           [ 0.0898122 , 0.0854362 , 0.17437172],
           [ 0.09269321, 0.08871107, 0.1815847 ],
           [ 0.09550767, 0.09197337, 0.1888454 ],
           [ 0.09825221, 0.09522511, 0.19615554],
           [ 0.10091896, 0.09846656, 0.20353447],
           [ 0.10350644, 0.10170191, 0.21096704],
           [ 0.1060106 , 0.10493436, 0.21844846],
           [ 0.1084256 , 0.10816684, 0.22597819],
           [ 0.11074483, 0.11140262, 0.23355481],
           [ 0.1129608 , 0.1146454 , 0.24117584],
           [ 0.11506504, 0.11789936, 0.24883741],
           [ 0.11704809, 0.12116924, 0.25653399],
           [ 0.11889935, 0.12446042, 0.26425804],
           [ 0.12060711, 0.12777898, 0.27199962],
           [ 0.12215848, 0.13113177, 0.27974594],
           [ 0.1235373 , 0.13452625, 0.28748536],
           [ 0.12471883, 0.13797062, 0.29521536],
           [ 0.12569515, 0.14147531, 0.30289176],
           [ 0.12644947, 0.14505038, 0.31048514],
           [ 0.12694405, 0.14870723, 0.31799003],
           [ 0.12717814, 0.15245684, 0.32533943],
           [ 0.12712056, 0.15631103, 0.33250658],
           [ 0.12677093, 0.16027833, 0.33942797],
           [ 0.12610722, 0.16436776, 0.346066  ],
           [ 0.12514753, 0.16858059, 0.35235698],
           [ 0.12390226, 0.17291542, 0.35826001],
           [ 0.12239485, 0.17736533, 0.36374235],
           [ 0.12066637, 0.18191676, 0.36878289],
           [ 0.11875592, 0.18655388, 0.37338041],
           [ 0.11670933, 0.19125793, 0.37754738],
           [ 0.11457153, 0.19600985, 0.38130874],
           [ 0.11237289, 0.20079421, 0.38469733],
           [ 0.11015564, 0.20559387, 0.38774968],
           [ 0.10794262, 0.21039736, 0.39050293],
           [ 0.10575349, 0.21519528, 0.39299227],
           [ 0.10361434, 0.21997803, 0.39525235],
           [ 0.10153158, 0.22474163, 0.39731156],
           [ 0.09951859, 0.22948144, 0.39919679],
           [ 0.09759277, 0.23419275, 0.40093399],
           [ 0.09574525, 0.23887727, 0.40253861],
           [ 0.0939969 , 0.24353063, 0.40403324],
           [ 0.09235004, 0.24815293, 0.40543281],
           [ 0.0907994 , 0.25274604, 0.40674742],
           [ 0.08934912, 0.25731   , 0.40798904],
           [ 0.08801187, 0.26184329, 0.40917207],
           [ 0.08678381, 0.26634782, 0.41030337],
           [ 0.08566085, 0.27082548, 0.41138859],
           [ 0.08464352, 0.27527724, 0.41243452],
           [ 0.08373159, 0.27970416, 0.41344708],
           [ 0.08292413, 0.2841074 , 0.41443136],
           [ 0.08221953, 0.28848815, 0.41539177],
           [ 0.0816163 , 0.29284753, 0.41633245],
           [ 0.08111398, 0.29718638, 0.41725776],
           [ 0.08070525, 0.30150669, 0.41816856],
           [ 0.08038644, 0.30580967, 0.41906722],
           [ 0.08015351, 0.31009655, 0.41995574],
           [ 0.08000202, 0.31436851, 0.42083578],
           [ 0.07992726, 0.31862673, 0.4217087 ],
           [ 0.07992426, 0.32287237, 0.42257561],
           [ 0.07998788, 0.32710653, 0.42343736],
           [ 0.08011282, 0.3313303 , 0.42429461],
           [ 0.08029369, 0.33554474, 0.4251478 ],
           [ 0.08052507, 0.33975087, 0.42599721],
           [ 0.08080155, 0.34394968, 0.42684295],
           [ 0.0811199 , 0.34814179, 0.42768611],
           [ 0.08147322, 0.35232836, 0.42852569],
           [ 0.08185587, 0.35651035, 0.42936117],
           [ 0.08226276, 0.3606886 , 0.43019214],
           [ 0.082689  , 0.36486394, 0.43101809],
           [ 0.08312988, 0.36903714, 0.43183839],
           [ 0.08358091, 0.37320895, 0.43265236],
           [ 0.08403782, 0.37738006, 0.43345921],
           [ 0.08449659, 0.38155115, 0.43425811],
           [ 0.08495348, 0.38572285, 0.43504814],
           [ 0.08540499, 0.38989577, 0.43582832],
           [ 0.08585058, 0.39407011, 0.43659896],
           [ 0.08628554, 0.39824666, 0.43735807],
           [ 0.08670614, 0.40242604, 0.438104  ],
           [ 0.08711003, 0.40660874, 0.43883557],
           [ 0.08749515, 0.41079517, 0.43955158],
           [ 0.08785974, 0.41498574, 0.44025078],
           [ 0.08820237, 0.41918081, 0.44093192],
           [ 0.08852225, 0.42338066, 0.44159386],
           [ 0.08882117, 0.42758529, 0.44223655],
           [ 0.0890954 , 0.43179535, 0.4428571 ],
           [ 0.08934478, 0.4360111 , 0.44345416],
           [ 0.08956948, 0.44023274, 0.44402639],
           [ 0.08977002, 0.44446045, 0.44457244],
           [ 0.08994726, 0.44869436, 0.44509096],
           [ 0.09010355, 0.45293448, 0.44558113],
           [ 0.09024044, 0.4571809 , 0.4460416 ],
           [ 0.09035834, 0.46143387, 0.4464703 ],
           [ 0.09045955, 0.46569341, 0.4468659 ],
           [ 0.09054677, 0.46995956, 0.44722708],
           [ 0.09062308, 0.47423228, 0.44755253],
           [ 0.09069227, 0.47851153, 0.44784112],
           [ 0.0907587 , 0.48279718, 0.44809181],
           [ 0.0908253 , 0.4870893 , 0.44830271],
           [ 0.09089677, 0.49138779, 0.4484726 ],
           [ 0.09097815, 0.49569254, 0.44860025],
           [ 0.09107494, 0.5000034 , 0.44868447],
           [ 0.091193  , 0.50432021, 0.44872411],
           [ 0.09133836, 0.50864282, 0.44871791],
           [ 0.0915173 , 0.51297107, 0.44866458],
           [ 0.09173677, 0.51730475, 0.44856302],
           [ 0.09200407, 0.52164364, 0.44841215],
           [ 0.09232674, 0.52598751, 0.44821092],
           [ 0.09271239, 0.53033611, 0.4479582 ],
           [ 0.09316803, 0.5346893 , 0.44765241],
           [ 0.09370257, 0.53904671, 0.44729297],
           [ 0.09432429, 0.54340806, 0.44687892],
           [ 0.09504147, 0.54777304, 0.44640933],
           [ 0.09586237, 0.55214134, 0.44588327],
           [ 0.096795  , 0.55651266, 0.44529978],
           [ 0.09784523, 0.56088688, 0.44465663],
           [ 0.0990226 , 0.56526346, 0.4439541 ],
           [ 0.10033447, 0.56964206, 0.44319134],
           [ 0.10178777, 0.5740223 , 0.44236755],
           [ 0.10338896, 0.57840383, 0.4414819 ],
           [ 0.10514395, 0.58278626, 0.44053362],
           [ 0.10705651, 0.5871694 , 0.43952058],
           [ 0.1091319 , 0.5915528 , 0.43844228],
           [ 0.11137519, 0.59593594, 0.43729876],
           [ 0.11378984, 0.60031841, 0.43608927],
           [ 0.11637863, 0.6046998 , 0.43481308],
           [ 0.11914372, 0.60907967, 0.43346946],
           [ 0.12208663, 0.61345758, 0.43205768],
           [ 0.12520714, 0.61783329, 0.43057538],
           [ 0.12850611, 0.62220628, 0.42902213],
           [ 0.13198434, 0.62657596, 0.42739835],
           [ 0.13564129, 0.63094186, 0.42570335],
           [ 0.13947601, 0.6353035 , 0.42393642],
           [ 0.14348723, 0.63966038, 0.42209686],
           [ 0.14767334, 0.644012  , 0.42018398],
           [ 0.15203255, 0.64835786, 0.41819708],
           [ 0.15656259, 0.6526975 , 0.41613446],
           [ 0.16126124, 0.65703049, 0.41399417],
           [ 0.16612684, 0.66135608, 0.41177763],
           [ 0.17115707, 0.66567373, 0.40948415],
           [ 0.1763496 , 0.66998285, 0.40711303],
           [ 0.18170207, 0.67428288, 0.40466358],
           [ 0.18721214, 0.6785732 , 0.40213511],
           [ 0.19287756, 0.68285319, 0.39952692],
           [ 0.19869609, 0.68712225, 0.39683833],
           [ 0.2046656 , 0.69137971, 0.39406864],
           [ 0.21078406, 0.69562491, 0.39121716],
           [ 0.21704951, 0.69985719, 0.38828323],
           [ 0.22346011, 0.70407585, 0.38526615],
           [ 0.23001456, 0.7082802 , 0.38216373],
           [ 0.23671098, 0.71246948, 0.37897654],
           [ 0.24354771, 0.71664292, 0.37570449],
           [ 0.25052331, 0.72079975, 0.37234698],
           [ 0.25763643, 0.72493919, 0.36890348],
           [ 0.26488583, 0.72906042, 0.36537348],
           [ 0.27227035, 0.73316263, 0.36175651],
           [ 0.27978892, 0.73724495, 0.35805217],
           [ 0.28744053, 0.74130654, 0.35426009],
           [ 0.29522426, 0.74534649, 0.35037999],
           [ 0.30313922, 0.74936391, 0.34641166],
           [ 0.31118459, 0.75335786, 0.34235499],
           [ 0.31935957, 0.75732741, 0.33820996],
           [ 0.32766337, 0.7612716 , 0.33397669],
           [ 0.33609522, 0.76518946, 0.32965544],
           [ 0.34465547, 0.76907991, 0.32524467],
           [ 0.35334317, 0.77294196, 0.32074533],
           [ 0.3621569 , 0.77677462, 0.31615932],
           [ 0.37109578, 0.78057688, 0.3114877 ],
           [ 0.38015888, 0.78434771, 0.30673177],
           [ 0.38934515, 0.7880861 , 0.30189315],
           [ 0.39865345, 0.79179104, 0.29697378],
           [ 0.40808253, 0.79546152, 0.29197602],
           [ 0.41763096, 0.79909656, 0.28690261],
           [ 0.42729718, 0.8026952 , 0.28175682],
           [ 0.43708157, 0.80625625, 0.27653921],
           [ 0.44698306, 0.80977865, 0.27125293],
           [ 0.45699663, 0.81326192, 0.26590739],
           [ 0.46711981, 0.81670528, 0.26050848],
           [ 0.47734986, 0.82010803, 0.25506295],
           [ 0.48768377, 0.82346952, 0.24957847],
           [ 0.49812101, 0.82678878, 0.24405975],
           [ 0.50865808, 0.83006528, 0.23851663],
           [ 0.51928789, 0.83329921, 0.23296476],
           [ 0.53000612, 0.83649039, 0.22741675],
           [ 0.54080814, 0.83963876, 0.22188673],
           [ 0.5516924 , 0.84274374, 0.21638573],
           [ 0.56265089, 0.84580608, 0.21093518],
           [ 0.57367656, 0.84882647, 0.20555658],
           [ 0.58476348, 0.85180551, 0.20027149],
           [ 0.59590672, 0.85474371, 0.19510194],
           [ 0.60709905, 0.8576422 , 0.19007487],
           [ 0.61833234, 0.86050243, 0.18522033],
           [ 0.62959985, 0.86332574, 0.18056836],
           [ 0.6408944 , 0.86611369, 0.17615141],
           [ 0.65220809, 0.86886821, 0.17200438],
           [ 0.66353411, 0.87159108, 0.16816209],
           [ 0.67486569, 0.87428426, 0.16466012],
           [ 0.68619446, 0.87695027, 0.16153602],
           [ 0.69751246, 0.87959171, 0.15882605],
           [ 0.70881546, 0.88221031, 0.15656078],
           [ 0.72009757, 0.88480839, 0.15477028],
           [ 0.73135277, 0.88738841, 0.15348113],
           [ 0.74256966, 0.88995457, 0.15271988],
           [ 0.75374916, 0.89250763, 0.1524964 ],
           [ 0.76488688, 0.89504992, 0.15281985],
           [ 0.77597885, 0.89758377, 0.1536928 ],
           [ 0.7870215 , 0.90011142, 0.15511132],
           [ 0.79800534, 0.90263717, 0.15706844],
           [ 0.80893276, 0.90516155, 0.15954489],
           [ 0.81980269, 0.90768623, 0.16251962],
           [ 0.83061328, 0.91021312, 0.1659685 ],
           [ 0.84136311, 0.91274407, 0.16986481],
           [ 0.85205108, 0.91528081, 0.17418013],
           [ 0.86267642, 0.91782496, 0.17888531],
           [ 0.87323869, 0.92037804, 0.18395118],
           [ 0.88373639, 0.92294199, 0.18934913],
           [ 0.89416889, 0.92551841, 0.19505144],
           [ 0.90453929, 0.92810751, 0.20103235],
           [ 0.9148482 , 0.93071038, 0.20726778],
           [ 0.92509644, 0.93332802, 0.21373546],
           [ 0.93528498, 0.93596133, 0.22041497],
           [ 0.94541497, 0.93861113, 0.22728776],
           [ 0.95548764, 0.94127816, 0.234337  ],
           [ 0.96550437, 0.94396308, 0.2415476 ],
           [ 0.97546662, 0.94666649, 0.24890602],
           [ 0.98537593, 0.94938892, 0.25640019],
           [ 0.9952339 , 0.95213082, 0.2640194 ]]

wide_viridis = ListedColormap(cm_data, name=__file__)


if __name__ == "__main__":
    import matplotlib.pyplot as plt
    import numpy as np

    try:
        from viscm import viscm
        viscm(wide_viridis)
    except ImportError:
        print("viscm not found, falling back on simple display")
        plt.imshow(np.linspace(0, 100, 256)[None, :], aspect='auto',
                   cmap=wide_viridis)
    plt.show()
